
<template name="reactionAnalysis" >
<p>
<button class="btn btn-success"  data-toggle="modal" data-target="#lineG"><i class="fa fa-line-chart"></i> Line Graph</button>
<canvas id="myChart" style="width:5px,height:5px"></canvas>
</p>
<p style="width:100px ,height:300px">

<div class="modal fade" id="barG" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h3><i class="fa fa-bar-chart"></i> Bar Data Graph Representation  </h3>
        </div>
        <div class="modal-body" style="width:300px;height: 300px">
          <canvas id="barGraph" width="50px" height="50px"></canvas>
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal"><i class="fa fa-remove"></i> Close</button>
        </div>
      </div>
    </div>
  </div>
  </p>
  <p>

  <div class="modal fade" id="lineG" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" width>
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h3><i class="fa fa-line-chart"></i> Line Graph Representation </h3>
        </div>
        <div class="modal-body" style="width:100%">
          <canvas id="lineGraph" style="width:5px,height:5px"></canvas>
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal"><i class="fa fa-remove"></i> Close</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="pieChart" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h3><i class="fa fa-pie-chart"></i> Pie Chart Representation </h3>
        </div>
        <div class="modal-body" style="width:300px;height: 300px">
          <canvas id="pieCharty" width="50px" height="50px"></canvas>
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal"><i class="fa fa-remove"></i> Close</button>
        </div>
      </div>
    </div>
  </div>
</p>

<script type="text/javascript">
const getOrders = () => {
  Meteor.call("orders/getOrder", (err, res) => {
    Session.set("orders", res);
  });
  var count = 0;

    for(var prop in Session.get("orders")) {
        ++count;
    }

  var month = new Array();
    month[0] = "January";
    month[1] = "February";
    month[2] = "March";
    month[3] = "April";
    month[4] = "May";
    month[5] = "June";
    month[6] = "July";
    month[7] = "August";
    month[8] = "September";
    month[9] = "October";
    month[10] = "November";
    month[11] = "December";

    monthOrders = {
    January: 0,
    February: 0,
    March: 0,
    April: 0,
    May: 0,
    June: 0,
    July: 0,
    August: 0,
    September: 0,
    October: 0,
    November: 0,
    December: 0
    };

    Session.get("orders").forEach( order => {
        orderMonth = month[(new Date(order.createdAt)).getMonth()];
        monthOrders[orderMonth] += 1;  
    }); 

    const bar = document.getElementById("myChart");
    const barGraph = new Chart(bar, {
    type: 'bar',
    data: {
        labels: Object.keys(monthOrders),
        datasets: [{
            label: 'No. of orders',
            data: Object.values(monthOrders),
            backgroundColor: [
                'rgba(236, 127, 0, 0.9)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(88, 44, 60, 0.9)',
                'rgba(6, 44, 60, 0.9)',
                'rgba(6, 26, 0, 0.9)',
                'rgba(6, 26, 142, 0.9)',
                'rgba(3, 139, 142, 0.9)',
                'rgba(3, 255, 255, 0.9)'

            ],
            borderColor: [
                'rgba(236, 127, 0, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(88, 44, 60, 1)',
                'rgba(6, 44, 60, 1)',
                'rgba(6, 26, 0, 1)',
                'rgba(6, 26, 142, 1)',
                'rgba(3, 139, 142, 1)',
                'rgba(3, 255, 255, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
});

const line = document.getElementById("lineGraph");
const lineGraph = new Chart(line, {
    type: 'line',
    data: {
        labels: Object.keys(monthOrders),
        datasets: [{
            label: 'No. of orders',
            data: Object.values(monthOrders),
            backgroundColor: [
                'rgba(236, 127, 0, 0.9)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(88, 44, 60, 0.9)',
                'rgba(6, 44, 60, 0.9)',
                'rgba(6, 26, 0, 0.9)',
                'rgba(6, 26, 142, 0.9)',
                'rgba(3, 139, 142, 0.9)',
                'rgba(3, 255, 255, 0.9)'

            ],
            borderColor: [
                'rgba(236, 127, 0, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(88, 44, 60, 1)',
                'rgba(6, 44, 60, 1)',
                'rgba(6, 26, 0, 1)',
                'rgba(6, 26, 142, 1)',
                'rgba(3, 139, 142, 1)',
                'rgba(3, 255, 255, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }],
        }
    }
});

  return Session.get("orders");
};
getOrders();
</script>
</template>
